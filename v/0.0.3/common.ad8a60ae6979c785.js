"use strict";(self.webpackChunk_modelnow_proto=self.webpackChunk_modelnow_proto||[]).push([[592],{3899:(z,L,t)=>{function k(h){const[M,d]=h.geometry.coordinates;return[d,M]}t.d(L,{D:()=>k})},3987:(z,L,t)=>{t.d(L,{U:()=>M});var y=t(6814),k=t(8467),h=t(5879);let M=(()=>{class d{constructor(f){this.appBaseHref=f}transform(f,E){if(null==f||""===f)return null;const A=this.appBaseHref?(0,k.pv)(this.appBaseHref,f):`${f}`;return"css"===E?`url(${A})`:A}}return d.\u0275fac=function(f){return new(f||d)(h.Y36(y.mr,24))},d.\u0275pipe=h.Yjl({name:"baseUrl",type:d,pure:!0,standalone:!0}),d})()},2749:(z,L,t)=>{t.d(L,{m:()=>I});var y=t(7582),k=t(6028),h=t(5879),M=t(8645),d=t(9773),g=t(6328),f=t(4366),E=t(5592),A=t(7453),D=t(4829),H=t(9940),O=t(8251),U=t(7400),P=t(2714),B=t(2096),b=t(4225),R=t(1137),T=t(6404);class I{get center(){return this._center}set center(e){"string"==typeof e&&e.length&&(e=e.split(",").map(r=>+r).slice(0,2)),Array.isArray(e)&&e.length>1&&(e[0]!==this._center[0]||e[1]!==this._center[1])&&(this._center=e,this._lMap?.setView(e),this.action$.next("refreshCenteredMarker"))}get centeredMarker(){return this._centeredMarker}set centeredMarker(e){e!==this._centeredMarker&&(this._centeredMarker=e,this.action$.next("refreshCenteredMarker"))}get markerIcons(){return this._markerIcons}set markerIcons(e){this._markerIcons=e,this.action$.next("refreshMarkerIcons")}get zoom(){return this._zoom}set zoom(e){e!==this._zoom&&(this._zoom=e,this._lMap?.setZoom(e))}constructor(e){this.elementRef=e,this._center=[48.854213,2.356361],this._centeredMarker=!1,this._markerIcons=[],this._zoom=15,this.markerIconActivate=new h.vpe,this.markerIconHover=new h.vpe,this._lMap=null,this._lCenteredMarker=null,this._lDefaultIcon=null,this._lMarkerIcons=[],this._lPromise=null,this.action$=new M.x,this.destroyed$=new M.x,this._lMarkerIconActivated=null,this._lMarkerIconHovered=null,this._eventListeners=[]}ngOnInit(){this.action$.pipe((0,d.R)(this.destroyed$),(0,g.b)(e=>"createMap"===e||this._lMap?(this._lPromise||(this._lPromise=t.e(433).then(t.t.bind(t,8433,23))),function $(...C){const e=(0,H.jO)(C),{args:r,keys:n}=(0,A.D)(C),o=new E.y(a=>{const{length:i}=r;if(!i)return void a.complete();const s=new Array(i);let c=i,v=i;for(let u=0;u<i;u++){let _=!1;(0,D.Xf)(r[u]).subscribe((0,O.x)(a,p=>{_||(_=!0,v--),s[u]=p},()=>c--,void 0,()=>{(!c||!_)&&(v||a.next(n?(0,P.n)(n,s):s),a.complete())}))}});return e?o.pipe((0,U.Z)(e)):o}({l:this._lPromise,action:(0,B.of)(e)})):f.C)).subscribe(({l:e,action:r})=>{"createMap"===r?this._createMap(e):"refreshCenteredMarker"===r?this._refreshCenteredMarker(e):"refreshMarkerIcons"===r?this._refreshMarkerIcons(e):console.error(`UiLeafletDirective::ngOnInit: unknown action ${r}`)})}ngAfterViewInit(){(0,b.Jj)()&&this.action$.next("createMap")}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete(),this._destroyMap()}_createMap(e){return this._lMap||(this._lMap=e.map(this.elementRef.nativeElement,{center:this._center,zoom:this._zoom}),this._lMap.attributionControl.setPrefix(""),e.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:"",maxZoom:20,subdomains:"abcd"}).addTo(this._lMap),this._refreshCenteredMarker(e),this._refreshMarkerIcons(e),this._refreshMarkerIconsAttributes(),this._lMap.addEventListener("zoom",()=>{this._refreshMarkerIconsAttributes()})),this._lMap}_destroyMap(){if(this._lMarkerIcons.length){for(const e of this._lMarkerIcons)this._removeAllEventListeners(e.marker),this._lMap?.removeLayer(e.marker);this._lMarkerIcons.length=0}this._lCenteredMarker&&(this._lMap?.removeLayer(this._lCenteredMarker),this._lCenteredMarker=null),this._lDefaultIcon&&(this._lDefaultIcon=null),this._lMap&&(this._lMap.remove(),this._lMap=null)}_getDefaultIcon(e){return this._lDefaultIcon||(this._lDefaultIcon=e.icon({iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]})),this._lDefaultIcon}_refreshCenteredMarker(e){this._centeredMarker?(this._lCenteredMarker||(this._lCenteredMarker=e.marker(this._center,{icon:this._getDefaultIcon(e),interactive:!1,keyboard:!1})),this._lMap&&!this._lMap.hasLayer(this._lCenteredMarker)&&this._lMap.addLayer(this._lCenteredMarker)):this._lCenteredMarker&&(this._lMap?.removeLayer(this._lCenteredMarker),this._lCenteredMarker.remove(),this._lCenteredMarker=null)}_refreshMarkerIcons(e){const r=[...this._markerIcons],n=[...this._lMarkerIcons],o=[],a=[];for(const s of r){const{id:c,latlng:v,icon:u,events:_,...p}=s;let l=n.find(x=>x.id===c);if(l)a.push(l);else{const x=e.divIcon(u),Z=e.marker(v,{...p,icon:x});l={id:c,icon:x,marker:Z,input:s,internals:{events:{click:()=>this._setLMarkerIconActived(l),focus:()=>this._setLMarkerIconHovered(l),blur:()=>this._unsetLMarkerIconHovered(l),mouseover:()=>this._setLMarkerIconHovered(l),mouseout:()=>this._unsetLMarkerIconHovered(l),keydown:({originalEvent:m})=>{m.keyCode===k.L_&&l!==this._lMarkerIconActivated||m.keyCode===k.K5?(m.preventDefault(),this._setLMarkerIconActived(l)):(m.keyCode===k.L_&&l===this._lMarkerIconActivated||m.keyCode===k.ZH||m.keyCode===k.yY||m.keyCode===k.hY)&&(m.preventDefault(),this._unsetLMarkerIconActived(l))}}}},o.push(l)}}const i=n.filter(s=>!a.includes(s));for(const s of i){this._removeAllEventListeners(s.marker),this._lMap?.removeLayer(s.marker);const c=this._lMarkerIcons.indexOf(s);-1!==c&&this._lMarkerIcons.splice(c,1)}for(const s of a)this._lMap&&!this._lMap.hasLayer(s.marker)&&this._lMap.addLayer(s.marker);for(const s of o)this._lMarkerIcons.push(s),this._lMap?.addLayer(s.marker);for(const s of[...a,...o])this._addAllEventListeners(s.marker,s.internals.events),s.input.events&&this._addAllEventListeners(s.marker,s.input.events)}_addAllEventListeners(e,r){Object.keys(r).forEach(o=>{const a=r[o];this._hasEventListener(e,o,a)||this._addEventListener(e,o,a)})}_addEventListener(e,r,n){if("blur"===r||"focus"===r||"focusin"===r||"focusout"===r){const{_icon:o}=e;o.addEventListener(r,n)}else e.addEventListener(r,n);this._eventListeners.push({target:e,eventName:r,handler:n})}_hasEventListener(e,r,n){return!!this._eventListeners.find(o=>o.target===e&&o.eventName===r&&o.handler===n)}_removeAllEventListeners(e){for(const r of[...this._eventListeners])r.target===e&&this._removeEventListener(e,r.eventName,r.handler)}_removeEventListener(e,r,n){if("blur"===r||"focus"===r||"focusin"===r||"focusout"===r){const{_icon:i}=e;i.removeEventListener(r,n)}else e.removeEventListener(r,n);const o=this._eventListeners.find(i=>i.target===e&&i.eventName===r&&i.handler===n),a=o?this._eventListeners.indexOf(o):-1;-1!==a&&this._eventListeners.splice(a,1)}_setLMarkerIconActived(e){e!==this._lMarkerIconActivated&&(this._lMarkerIconActivated=e,this._refreshMarkerIconsAttributes(),this.markerIconActivate.emit(e))}_unsetLMarkerIconActived(e){e===this._lMarkerIconActivated&&(this._lMarkerIconActivated=null,this._refreshMarkerIconsAttributes(),this.markerIconActivate.emit(null))}_setLMarkerIconHovered(e){e!==this._lMarkerIconHovered&&(this._lMarkerIconHovered=e,this._refreshMarkerIconsAttributes(),this.markerIconHover.emit(e))}_unsetLMarkerIconHovered(e){e===this._lMarkerIconHovered&&(this._lMarkerIconHovered=null,this._refreshMarkerIconsAttributes(),this.markerIconHover.emit(null))}_refreshMarkerIconsAttributes(){if(this._lMarkerIcons.length<2)return;const{_lMarkerIconActivated:e,_lMarkerIconHovered:r}=this,n=[...this._lMarkerIcons].sort((i,s)=>{const{_zIndex:c}=i.marker,{_zIndex:v}=s.marker;return c-v}),{_zIndex:o}=n[0].marker,{_zIndex:a}=n[n.length-1].marker;n.forEach((i,s)=>{const{_icon:c,_updateZIndex:u}=i.marker,_=i===e,p=i===r;_?c.classList.add("ui-leaflet-marker-icon--activate"):c.classList.remove("ui-leaflet-marker-icon--activate"),p?c.classList.add("ui-leaflet-marker-icon--hover"):c.classList.remove("ui-leaflet-marker-icon--hover");const l=_?a+1:p?a+2:o+s;i.marker._zIndex=l,u.call(i.marker,l)})}}I.\u0275fac=function(e){return new(e||I)(h.Y36(h.SBq))},I.\u0275dir=h.lG2({type:I,selectors:[["","ui-leaflet",""]],hostAttrs:[1,"ui-leaflet"],inputs:{center:["ui-leaflet","center"],centeredMarker:["ui-leaflet-centered-marker","centeredMarker"],markerIcons:["ui-leaflet-marker-icons","markerIcons"],zoom:["ui-leaflet-zoom","zoom"]},outputs:{markerIconActivate:"ui-leaflet-marker-icon-activate",markerIconHover:"ui-leaflet-marker-icon-hover"},exportAs:["uiLeaflet"],standalone:!0}),(0,y.gn)([(0,R.x)()],I.prototype,"centeredMarker",null),(0,y.gn)([(0,T.Y)()],I.prototype,"zoom",null)}}]);